# ğŸ“¦ Projet Terraform â€“ Infrastructure AWS pour Application de RÃ©servation

Bienvenue ! Ce dÃ©pÃ´t contient le code Terraform permettant de dÃ©ployer une infrastructure **cloud-native**, **scalable** et **sÃ©curisÃ©e** sur AWS, destinÃ©e Ã  hÃ©berger une application web de rÃ©servation de tables dans un restaurant. Le projet est modulaire, reproductible et conforme aux meilleures pratiques DevSecOps.

---

## âœ¨ Objectif

- DÃ©ployer une application web de rÃ©servation de tables avec frontend statique
- Backend dÃ©ployÃ© sur ECS Fargate
- Stockage des donnÃ©es via Aurora PostgreSQL
- Authentification utilisateur avec Cognito
- SÃ©curitÃ©, audit, supervision et chiffrement intÃ©grÃ©s

---

## ğŸ—‚ï¸ Arborescence du projet

```
TABLE-RESERVE-INFRA/
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ acm                         # Certificats SSL
â”‚   â”œâ”€â”€ alb                         # Application Load Balancer
â”‚   â”œâ”€â”€ aurora                      # Cluster Aurora PostgreSQL
â”‚   â”œâ”€â”€ bastion                     # HÃ´te Bastion EC2
â”‚   â”œâ”€â”€ cloudfront                  # CDN pour le frontend
â”‚   â”œâ”€â”€ cloudwatch                  # Logs & monitoring
â”‚   â”œâ”€â”€ cognito                     # Authentification utilisateurs
â”‚   â”œâ”€â”€ ecr                         # Registre Docker
â”‚   â”œâ”€â”€ ecs-fargate                 # Services backend sur Fargate
â”‚   â”œâ”€â”€ iam                         # RÃ´les et politiques IAM
â”‚   â”œâ”€â”€ kms                         # Chiffrement avec KMS
â”‚   â”œâ”€â”€ Route53                     # DNS
â”‚   â”œâ”€â”€ s3                          # Buckets S3 (frontend & logs)
â”‚   â”œâ”€â”€ security                    # CloudTrail, GuardDuty, Budgets
â”‚   â”œâ”€â”€ sg                          # Groupes de sÃ©curitÃ©
â”‚   â”œâ”€â”€ vpc                         # RÃ©seaux VPC publics/privÃ©s
â”‚   â”œâ”€â”€ vpc-peering                 # Peering entre VPCs
â”‚   â”œâ”€â”€ waf                         # Web Application Firewall
â”‚   â””â”€â”€ websocket                   # API Gateway WebSocket
â”‚
â”œâ”€â”€ project-root/
â”‚   â”œâ”€â”€ main.tf                     # Assemblage des modules
â”‚   â”œâ”€â”€ variables.tf                # Variables globales
â”‚   â”œâ”€â”€ outputs.tf                  # Outputs Terraform
â”‚   â”œâ”€â”€ provider.tf                 # Fournisseur AWS
â”‚   â”œâ”€â”€ terraform.tfvars            # Valeurs concrÃ¨tes
â”‚   â””â”€â”€ terraform.lock.hcl          # Lockfile
```

---

## â˜ï¸ Services AWS utilisÃ©s

- **VPC** (2 rÃ©gions, peering)
- **ALB** en HTTPS pour le backend
- **ECS Fargate** pour les conteneurs applicatifs
- **Aurora PostgreSQL** (multi-AZ)
- **S3 + CloudFront** pour le frontend statique
- **Cognito** pour la gestion des utilisateurs
- **WAF**, **IAM**, **CloudWatch**, **GuardDuty**, **Budgets** pour la sÃ©curitÃ©
- **API Gateway WebSocket** pour le temps rÃ©el

---

## ğŸ” SÃ©curitÃ© & Bonnes pratiques

- AccÃ¨s sÃ©curisÃ© via `aws-vault`
- IAM en principe du moindre privilÃ¨ge
- Chiffrement KMS des donnÃ©es sensibles
- Journaux avec CloudTrail et alertes avec GuardDuty
- Segmentation rÃ©seau avec subnets publics/privÃ©s
- Gestion proactive des coÃ»ts via AWS Budgets

---

## âœ… Scan tfsec â€“ SÃ©curitÃ© Infra

| Niveau   | Description                                                            | Statut |
|----------|------------------------------------------------------------------------|--------|
| HIGH     | ALB exposÃ© (protÃ©gÃ© par WAF)                                          | âœ… OK |
| MEDIUM   | Absence logs WebSocket en test                                        | âœ… OK |
| LOW      | ClÃ©s KMS gÃ©rÃ©es par AWS (CMK recommandÃ© en prod)                      | âœ… OK |
| LOW      | Performance Insights dÃ©sactivÃ© sur Aurora                             | âœ… OK |
| LOW      | Logs CloudWatch non chiffrÃ©s avec CMK                                 | âœ… OK |

---

## âš ï¸ ProblÃ¨me Route53

Erreur possible :
```bash
Error: no matching Route 53 Hosted Zone found
```
**Solution** :
- CrÃ©er manuellement la zone DNS via la console AWS
- Ou commenter le module `route53` dans `main.tf`

---

## ğŸš€ DÃ©ploiement local avec aws-vault

```bash
aws-vault exec unify -- terraform init
aws-vault exec unify -- terraform validate
aws-vault exec unify -- terraform plan -out=tfplan
```

---

## ğŸ” IntÃ©gration CI/CD GitLab

Le pipeline CI/CD inclut :

- `tfsec` pour la sÃ©curitÃ© Terraform
- `tflint` pour les bonnes pratiques
- `snyk`, `trivy` pour la sÃ©curitÃ© des conteneurs
- Ã‰tapes de `plan` et `apply` avec approbation manuelle

---

## ğŸ“ Auteur

**Fabrice TSAFACK**  
DevSecOps | Cloud | Terraform | Kubernetes  
ğŸ“§ ronicefabrice@gmail.com