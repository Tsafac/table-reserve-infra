# ğŸ“¦ Projet Terraform â€“ Infrastructure AWS pour Application de RÃ©servation

## âœ¨ Objectif
Ce projet met en place une infrastructure cloud complÃ¨te et modulaire sur AWS pour une application de rÃ©servation. Elle est dÃ©crite Ã  l'aide de Terraform, selon une architecture multi-AZ et conforme aux bonnes pratiques DevOps et sÃ©curitÃ©.

## ğŸ—‚ï¸ Arborescence du projet

```
TABLE-RESERVE-INFRA/
â”œâ”€â”€ modules/                        # Modules Terraform rÃ©utilisables
â”‚   â”œâ”€â”€ acm                         # Certificats ACM (frontend/backend)
â”‚   â”œâ”€â”€ alb                         # Load Balancer HTTP/HTTPS
â”‚   â”œâ”€â”€ aurora                      # Cluster RDS Aurora PostgreSQL
â”‚   â”œâ”€â”€ bastion                     # EC2 Bastion host pour accÃ¨s SSH
â”‚   â”œâ”€â”€ cloudfront                  # CDN pour le frontend
â”‚   â”œâ”€â”€ cloudwatch                  # Logs ECS et mÃ©triques CloudWatch
â”‚   â”œâ”€â”€ cognito                     # Authentification utilisateur
â”‚   â”œâ”€â”€ ecr                         # Registry pour les images Docker
â”‚   â”œâ”€â”€ ecs-fargate                 # DÃ©ploiement backend via ECS Fargate
â”‚   â”œâ”€â”€ iam                         # RÃ´les IAM nÃ©cessaires
â”‚   â”œâ”€â”€ kms                         # ClÃ©s de chiffrement KMS
â”‚   â”œâ”€â”€ Route53                     # Enregistrements DNS
â”‚   â”œâ”€â”€ s3                          # Buckets S3 (frontend et logs)
â”‚   â”œâ”€â”€ security                    # CloudTrail, GuardDuty, Budget
â”‚   â”œâ”€â”€ sg                          # Security Groups (ECS, Bastion, ALB...)
â”‚   â”œâ”€â”€ vpc                         # CrÃ©ation des VPCs publics/privÃ©s
â”‚   â”œâ”€â”€ vpc-peering                 # Peering entre VPC 1 et VPC 2
â”‚   â”œâ”€â”€ waf                         # Web Application Firewall (CloudFront/ALB)
â”‚   â””â”€â”€ websocket                   # API Gateway WebSocket
â”‚
â”œâ”€â”€ project-root/
â”‚   â”œâ”€â”€ main.tf                     # Composition globale (appel des modules)
â”‚   â”œâ”€â”€ variables.tf                # DÃ©claration des variables globales
â”‚   â”œâ”€â”€ outputs.tf                  # Valeurs exportÃ©es
â”‚   â”œâ”€â”€ provider.tf                 # Configuration AWS (multi-rÃ©gion)
â”‚   â”œâ”€â”€ terraform.tfvars            # Valeurs concrÃ¨tes des variables
â”‚   â”œâ”€â”€ terraform.lock.hcl          # Lockfile provider
â”‚   â””â”€â”€ README.md                   # Ce fichier
```

## â˜ï¸ Stack AWS utilisÃ©e

- **Amazon VPC** â€“ Deux VPC interconnectÃ©s (peering)
- **ALB** â€“ Pour l'exposition du backend (HTTPS)
- **Amazon ECS (Fargate)** â€“ DÃ©ploiement du backend
- **Amazon Aurora PostgreSQL** â€“ Base de donnÃ©es managÃ©e
- **Amazon Cognito** â€“ Authentification des utilisateurs
- **Amazon CloudFront + S3** â€“ Distribution frontend statique
- **Amazon WAF** â€“ SÃ©curitÃ© applicative en couche 7
- **API Gateway WebSocket** â€“ Communication temps rÃ©el
- **IAM, CloudWatch, GuardDuty, Budgets** â€“ SÃ©curitÃ© et observabilitÃ©

## ğŸ” SÃ©curitÃ© et bonnes pratiques

- ğŸ”‘ Gestion sÃ©curisÃ©e des identifiants via **aws-vault**
- ğŸ”’ IAM : rÃ´les les plus restrictifs possibles selon le principe de moindre privilÃ¨ge
- ğŸ” Buckets S3 chiffrÃ©s, bloquÃ©s en accÃ¨s public, avec versioning et logs activÃ©s
- ğŸ§± Architecture en **subnets privÃ©s et publics**
- ğŸ“œ **CloudTrail** et **GuardDuty** activÃ©s pour lâ€™audit et la dÃ©tection dâ€™anomalies
- ğŸ“‰ Budgets AWS configurÃ©s pour Ã©viter les dÃ©rives de coÃ»ts
- ğŸ” KMS utilisÃ© pour le chiffrement des logs, secrets et donnÃ©es sensibles

## âœ… Ã‰tat de la sÃ©curitÃ© (`tfsec`)

Un scan a Ã©tÃ© effectuÃ© avec [`tfsec`](https://github.com/aquasecurity/tfsec).

### RÃ©sumÃ© :
- âœ… **0 findings critiques**
- âš ï¸ **1 finding HIGH (justifiÃ©)**
- âš ï¸ Quelques findings LOW/MEDIUM documentÃ©s

### DÃ©tails :
| Niveau   | Description                                                                                 | Statut |
|----------|----------------------------------------------------------------------------------------------|--------|
| HIGH     | **ALB exposÃ© publiquement** â€“ JustifiÃ© car protÃ©gÃ© par un **WAF** en amont                  | âœ”ï¸ OK |
| MEDIUM   | **Absence de logs WebSocket** â€“ Non bloquant pour un environnement de test                  | âœ”ï¸ OK |
| LOW      | **ClÃ©s KMS gÃ©rÃ©es par AWS** â€“ Pas bloquant, amÃ©liorable avec des CMK personnalisÃ©es         | âœ”ï¸ OK |
| LOW      | **Performance Insights dÃ©sactivÃ© (Aurora)** â€“ Activable si besoin en production              | âœ”ï¸ OK |
| LOW      | **CloudWatch log group non chiffrÃ© avec CMK** â€“ Peu critique pour environnement temporaire  | âœ”ï¸ OK |

## âš ï¸ ProblÃ¨me volontaire sur Route53

Une erreur peut apparaÃ®tre Ã  lâ€™exÃ©cution :

```
Error: no matching Route 53 Hosted Zone found
```

ğŸ¯ **Explication** :  
Le module `Route53` recherche une zone DNS (`data "aws_route53_zone"`) qui **nâ€™a pas Ã©tÃ© crÃ©Ã©e dans AWS**.

ğŸ› ï¸ **Solution** :
- CrÃ©e manuellement la zone DNS sur AWS (recommandÃ©)
- Ou commente temporairement le module `route53` dans `main.tf` pour bypasser ce check

## ğŸš€ DÃ©ploiement local (via aws-vault)

```bash
# Initialisation du projet
aws-vault exec unify -- terraform init

# Validation de la syntaxe Terraform
aws-vault exec unify -- terraform validate

# Planification des changements
aws-vault exec unify -- terraform plan -out=tfplan
```

## ğŸ§  Notes supplÃ©mentaires

- âœ… Toutes les ressources critiques sont **versionnÃ©es**, **chiffrÃ©es**, et **monitorÃ©es**
- ğŸ“¦ Lâ€™infrastructure est **100% modulaire** (reutilisable sur d'autres projets)
- ğŸ“Š PrÃ©paration Ã  lâ€™usage en **environnement de production** avec quelques ajustements mineurs

## ğŸ“ Auteur

**Fabrice TSAFACK**  
DevSecOps | Cloud | SÃ©curitÃ© | Terraform | Kubernetes  
ğŸ“§ `ronicefabrice@gmail.com`